{% load i18n mathfilters %}

<section id="charges" class="text-center mb-3 mt-5">

<h2 class="title-sketch-highlight">{% trans 'Charges' %}</h2>


    
    {% if total_charges == 0 %}
    <div class="mt-3 mb-3">
    <a href="{% url 'add_car_participation' car.id %}" class="rounded-btn btn-kdark">{% trans "Indiquer répartition pour l'achat" %}</a>
    </div>

    <div class="mt-3 mb-3">
    <a href="#" class="rounded-btn btn-kbrand">{% trans "Ajouter une autre dépense" %}</a>
    </div>
    {% else %}
    <h4>{% trans 'Total des charges' %}</h4>
    
    <p class="text-center amount-info">{{total_charges}} €</p>
    {% for total_by_user in totals_paid_by_user %}
    <div class="profile-minicard mt-3">
        <img src={{total_by_user.user.avatar.url}} alt="{{ total_by_user.user.username }}">
                    <p>{{ total_by_user.user.username }}</p>
                    <p class="amount-info">{{total_by_user.paid_by_user}} €</p>
                    {% if total_charges != 0%}
                    <p>{{total_by_user.paid_by_user|mul:100|div:total_charges|floatformat:2}} %</p>
                    
                    {% endif %}
                    </div>

     
    {% endfor %}
    <div class="chart-container">
    <canvas id="totalCharges" width="100%" height="100%"></canvas>
    </div>

    <div class="chart-container">
     <canvas id="repartCharges" width="400" height="400"></canvas>
    </div>

    <a href="{% url 'costs_detail' car.slug car.id %}" class="rounded-btn btn-kdark">{% trans 'Regarder sous le capot' %}</a>
    {% endif %}
    



</section>